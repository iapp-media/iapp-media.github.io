<!DOCTYPE html>
<html lang="tw">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>iApp Platform</title>
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/index.css">
    <link rel="stylesheet" type="text/css" href="css/masonry.css">
    <!-- HTML5 shim and Respond.js 讓 IE8 支援 HTML5 元素與媒體查詢 -->
    <!-- 警告：Respond.js 無法在 file:// 協定下運作 -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body data-spy="scroll" data-target=".bs-docs-sidebar">
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="row">
            <div class="container-fluid">
                <div class="col-xs-4 col-sm-2 col-md-1 navbar-header">
                    <a class="navbar-brand" href="#">
                        <img class="iapplogo" src="images/iapplogo.png">
                    </a>
                </div>
                <div class="col-xs-4 search-sm">
                    <a href=""><span class="glyphicon glyphicon-search" aria-hidden="true"></span></a>
                </div>
                <div class="col-xs-3 login-sm">
                    <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                </div>
                <div class="col-xs-1 col-sm-5 col-md-8">
                    <div class="input-group search">
                        <input type="text" class="form-control " placeholder="Search iApp...">
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-default dropdown-toggle select" data-toggle="dropdown" aria-expanded="false">
                                <span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                <li><a href="#">basic</a></li>
                                <li class="divider"></li>
                                <li><a href="#">旅遊風</a></li>
                                <li><a href="#">生活風</a></li>
                                <li><a href="#">節慶風</a></li>
                            </ul>
                        </div>
                        <!-- /btn-group -->
                    </div>
                    <!-- /input-group -->
                </div>
                <div class="col-sm-2 col-md-1">
                    <button type="button" class="btn btn-default navbar-btn1"><h4 class="title">登入／註冊
                    </button>
                </div>
                <div class="col-sm-2 col-md-1 se">
                    <div class="separate"></div>
                </div>
                <div class="col-sm-1 col-md-1">
                    <button type="button" class="btn btn-default navbar-btn2"><h4 class="title">微創作
                    <span class="glyphicon glyphicon glyphicon glyphicon-hand-right" aria-hidden="true"></span>
                    </button>
                </div>
            </div>
            <!-- /.col-lg-6 -->
        </div>
    </nav>
    <!-- <div class="jumbotron">
        <div class="container">
            <h1>Hello, world!</h1>
            <p>...</p>
            <p><a class="btn btn-primary btn-lg" href="#" role="button">Learn more</a></p>
        </div>
    </div> -->
    <div class="container content">
        <!-- 瀑布流 -->
        <div id="masonry" class="container-fluid">
        </div>
        <div id="masonry_ghost" class="hide">
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="picture1.jpg">
                </div>
                <div class="caption">
                    <div class="title">test1</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=2426">小小生</a>
                    </div>
                </div>
            </div>
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="picture2.jpg">
                </div>
                <div class="caption">
                    <div class="title">test2</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=227">wangdotnet</a>
                    </div>
                </div>
            </div>
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="picture3.jpg">
                </div>
                <div class="caption">
                    <div class="title">test3</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=672">拓梦·D</a>
                    </div>
                </div>
            </div>
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="picture4.jpg">
                </div>
                <div class="caption">
                    <div class="title">test4</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=160">☆幻~精灵</a>
                    </div>
                </div>
            </div>
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="picture5.jpg">
                </div>
                <div class="caption">
                    <div class="title">test5</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=970">蓝色天空</a>
                    </div>
                </div>
            </div>
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="picture6.jpg">
                </div>
                <div class="caption">
                    <div class="title">test6</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=552">孤独的过客</a>
                    </div>
                </div>
            </div>
            <div class="thumbnail">
                <div class="imgs">
                    <input type="hidden" value="miniApp.jpg">
                </div>
                <div class="caption">
                    <div class="title">test7</div>
                    <div class="content">
                    </div>
                    <div class="author">
                        by <a target="_blank" href="http://fineui.com/bbs/home.php?mod=space&uid=1431">CoolHots</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="container content"></div>
    <!-- jQuery (Bootstrap 所有外掛均需要使用) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js">
    </script>
    <!-- 依需要參考已編譯外掛版本（如下），或各自獨立的外掛版本 -->
    <script src="js/bootstrap.min.js"></script>
    <script src="js/masonry.pkgd.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script>
    $(function() {

        var ghostNode = $('#masonry_ghost').find('.thumbnail'),
            i, ghostIndexArray = [];
        var ghostCount = ghostNode.length;
        for (i = 0; i < ghostCount; i++) {
            ghostIndexArray[i] = i;
        }
        ghostIndexArray.sort(function(a, b) {
            if (Math.random() > 0.5) {
                return a - b;
            } else {
                return b - a;
            }
        });

        var currentIndex = 0;
        var masNode = $('#masonry');
        var imagesLoading = false;


        function getNewItems() {
            var newItemContainer = $('<div/>');
            for (var i = 0; i < 6; i++) {
                if (currentIndex < ghostCount) {
                    newItemContainer.append(ghostNode.get(ghostIndexArray[currentIndex]));
                    currentIndex++;
                }
            }
            return newItemContainer.find('.thumbnail');
        }

        function processNewItems(items) {
            items.each(function() {
                var $this = $(this);
                var imgsNode = $this.find('.imgs');
                var title = $this.find('.title').text();
                var author = $this.find('.author').text();
                title += '&nbsp;&nbsp;(' + author + ')';
                var lightboxName = 'lightbox_'; // + imgNames[0];

                var imgNames = imgsNode.find('input[type=hidden]').val().split(',');
                $.each(imgNames, function(index, item) {
                    imgsNode.append('<a href=><img src="images/' + item + '" /></a>');
                });
            });
        }

        function initMasonry() {
            var items = getNewItems().css('opacity', 0);
            processNewItems(items);
            masNode.append(items);

            imagesLoading = true;
            items.imagesLoaded(function() {
                imagesLoading = false;
                items.css('opacity', 1);
                masNode.masonry({
                    itemSelector: '.thumbnail',
                    isFitWidth: true
                });
            });
        }


        function appendToMasonry() {
            var items = getNewItems().css('opacity', 0);
            processNewItems(items);
            masNode.append(items);

            imagesLoading = true;
            items.imagesLoaded(function() {
                imagesLoading = false;
                items.css('opacity', 1);
                masNode.masonry('appended', items);
            });
        }


        initMasonry();

        $(window).scroll(function() {

            if ($(document).height() - $(window).height() - $(document).scrollTop() < 10) {

                if (!imagesLoading) {
                    appendToMasonry();
                }

            }

        });


    });
    </script>

</body>

</html>
