/*! jQuery tinyMap, Licensed MIT (c) essoduke.org | http://app.essoduke.org/tinyMap/ */
window.gMapsCallback=function(){$(window).trigger("gMapsCallback")};
(function(k,u,r,w){function q(a,b){var c={lat:"",lng:""},d=[],e=/^[+-]?\d+(\.\d+)?$/;if("string"===typeof a||Array.isArray(a))if(d=Array.isArray(a)?a:a.toString().replace(/\s+/,"").split(","),2===d.length)e.test(d[0])&&e.test(d[1])&&(c.lat=d[0],c.lng=d[1]);else return a;else if("object"===typeof a){if("function"===typeof a.lat)return a;a.hasOwnProperty("x")&&a.hasOwnProperty("y")?(c.lat=a.x,c.lng=a.y):a.hasOwnProperty("lat")&&a.hasOwnProperty("lng")&&(c.lat=a.lat,c.lng=a.lng)}return!0===b?new google.maps.LatLng(c.lat,
c.lng):c}function v(a){var b=a.hasOwnProperty("css")?a.css.toString():"";this.setValues(a);this.span=k("<span/>").css({position:"relative",left:"-50%",top:"0","white-space":"nowrap"}).addClass(b);this.div=k("<div/>").css({position:"absolute",display:"none"});this.span.appendTo(this.div)}function x(a,b){var c=this,d=k.extend({},C,b);c.map=null;c._markers=[];c._markersCluster=[];c._clusters={};c._bounds={};c._labels=[];c._polylines=[];c._polygons=[];c._circles=[];c._kmls=[];c._directions=[];c._directionsMarkers=
[];c._places=[];c.container=a;c.options=d;c.googleMapOptions={};c.interval=parseInt(c.options.interval,10)||200;k(u).on("gMapsCallback",function(){c.init()});k(this.container).html(d.loading);c.init()}var z=!1,A=!1,B=!1,t={sensor:!1,language:"zh-TW",callback:"gMapsCallback",api:"//maps.googleapis.com/maps/api/js",clusterer:"//google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclustererplus/src/markerclusterer_packed.js",withLabel:"//google-maps-utility-library-v3.googlecode.com/svn/trunk/markerwithlabel/src/markerwithlabel_packed.js"},
C={autoLocation:!1,center:[24,121],infoWindowAutoClose:!0,interval:200,loading:"\u8b80\u53d6\u4e2d&hellip;",notFound:"\u627e\u4e0d\u5230\u67e5\u8a62\u7684\u5730\u9ede",zoom:8},y={},y={greyscale:[{featureType:"all",stylers:[{saturation:-100},{gamma:.5}]}]};x.prototype={VERSION:"3.2.16",formatSize:function(a){return Array.isArray(a)&&2===a.length?new google.maps.Size(a[0],a[1]):a},formatPoint:function(a){return Array.isArray(a)&&2===a.length?new google.maps.Point(a[0],a[1]):a},overlay:function(){var a=
this.map,b=this.options;try{this.adsense(a,b),this.kml(a,b),this.direction(a,b),this.markers(a,b),this.drawPolyline(a,b),this.drawPolygon(a,b),this.drawCircle(a,b),this.streetView(a,b),this.places(a,b),this.geoLocation(a,b)}catch(c){console.warn(c)}},bindEvents:function(a,b){var c=this,d={};switch(typeof b){case "function":google.maps.event.addListener(a,"click",b);break;case "object":for(d in b)"function"===typeof b[d]?google.maps.event.addListener(a,d,b[d]):b[d].hasOwnProperty("func")&&"function"===
typeof b[d].func?b[d].hasOwnProperty("once")&&!0===b[d].once?google.maps.event.addListenerOnce(a,d,b[d].func):google.maps.event.addListener(a,d,b[d].func):"function"===typeof b[d]&&google.maps.event.addListener(a,d,b[d])}a.hasOwnProperty("infoWindow")&&google.maps.event.addListener(a,"click",function(){var b=0,d={};if(c.options.hasOwnProperty("infoWindowAutoClose")&&!0===c.options.infoWindowAutoClose)for(b=0;b<c._markers.length;b+=1)d=c._markers[b],d.hasOwnProperty("infoWindow")&&"function"===typeof d.infoWindow.close&&
d.infoWindow.close();a.infoWindow.open(c.map,a)})},adsense:function(a,b){var c={};b.hasOwnProperty("adsense")&&(c=k.extend({},{map:a,format:"BANNER",position:"TOP",publisherId:"",channelNumber:""},b.adsense),c.format="undefined"!==google.maps.adsense.AdFormat[c.format]?google.maps.adsense.AdFormat[c.format]:google.maps.adsense.AdFormat.BANNER,c.position="undefined"!==google.maps.ControlPosition[c.position]?google.maps.ControlPosition[c.position]:google.maps.ControlPosition.TOP_CENTER,new google.maps.adsense.AdUnit(r.createElement("div"),
c))},kml:function(a,b){var c={url:"",map:a,preserveViewport:!1,suppressInfoWindows:!1},d={},e=0;if(b.hasOwnProperty("kml"))if("string"===typeof b.kml)c.url=b.kml,d=new google.maps.KmlLayer(c),this._kmls.push(d);else if(Array.isArray(b.kml))for(e=0;e<b.kml.length;e+=1)"string"===typeof b.kml[e]?(c.url=b.kml[e],d=new google.maps.KmlLayer(c)):"object"===typeof b.kml[e]&&(c=k.extend({},c,b.kml[e]),d=new google.maps.KmlLayer(c),c.hasOwnProperty("event")&&this.bindEvents(d,c.event)),this._kmls.push(d)},
drawPolyline:function(a,b){var c={},d=[],e={},f={},g={},g={},h=[],l=[],p=0,g={},g={},m=0,D=function(a,b){if(b===google.maps.DirectionsStatus.OK){for(m=0;m<a.routes[0].overview_path.length;m+=1)l.push(a.routes[0].overview_path[m]);e.setPath(l);"function"===typeof c.getDistance&&(f=a.routes[0].legs[0].distance,c.getDistance.call(this,f))}};if(b.hasOwnProperty("polyline")&&Array.isArray(b.polyline))for(p=0;p<b.polyline.length;p+=1)if(c=b.polyline[p],c.hasOwnProperty("coords")&&Array.isArray(c.coords)){h=
new google.maps.MVCArray;for(m=0;m<c.coords.length;m+=1)g=c.coords[m],g=q(g,!0),"function"===typeof g.lat&&h.push(g);g=k.extend({},{strokeColor:c.color||"#FF0000",strokeOpacity:c.opacity||1,strokeWeight:c.width||2},c);e=new google.maps.Polyline(g);this._polylines.push(e);if(2<h.getLength())for(m=0;m<h.length;m+=1)0<m&&h.length-1>m&&d.push({location:h.getAt(m),stopover:!1});e&&g.hasOwnProperty("event")&&g.event.hasOwnProperty("created")&&"function"===typeof g.event.created&&g.event.created.call(e,
this);c.hasOwnProperty("event")&&this.bindEvents(e,c.event);c.hasOwnProperty("snap")&&!0===c.snap?(g=new google.maps.DirectionsService,g.route({origin:h.getAt(0),waypoints:d,destination:h.getAt(h.length-1),travelMode:google.maps.DirectionsTravelMode.DRIVING},D)):(e.setPath(h),google.maps.hasOwnProperty("geometry")&&google.maps.geometry.hasOwnProperty("spherical")&&"function"===typeof google.maps.geometry.spherical.computeDistanceBetween&&(f=google.maps.geometry.spherical.computeDistanceBetween(h.getAt(0),
h.getAt(h.length-1)),"function"===typeof c.getDistance&&c.getDistance.call(this,f)));e.setMap(a)}},drawPolygon:function(a,b){var c={},d={},c=[],e=0,d=0,f={},f={};if(b.hasOwnProperty("polygon")&&Array.isArray(b.polygon))for(e=0;e<b.polygon.length;e+=1)if(c=[],b.polygon[e].hasOwnProperty("coords")){for(d=0;d<b.polygon[e].coords.length;d+=1)f=b.polygon[e].coords[d],f=q(f,!0),"function"===typeof f.lat&&c.push(f);d=k.extend({},{path:c,strokeColor:b.polygon[e].color||"#FF0000",strokeOpacity:1,strokeWeight:b.polygon[e].width||
2,fillColor:b.polygon[e].fillcolor||"#CC0000",fillOpacity:.35},b.polygon[e]);c=new google.maps.Polygon(d);this._polygons.push(c);c.setMap(a);c&&d.hasOwnProperty("event")&&d.event.hasOwnProperty("created")&&"function"===typeof d.event.created&&d.event.created.call(c,this);d.hasOwnProperty("event")&&this.bindEvents(c,d.event)}},drawCircle:function(a,b){var c={},d={},e={},f={},g=0;if(b.hasOwnProperty("circle")&&Array.isArray(b.circle))for(g=0;g<b.circle.length;g+=1)d=b.circle[g],e=k.extend({},{map:a,
strokeColor:d.color||"#FF0000",strokeOpacity:d.opacity||.8,strokeWeight:d.width||2,fillColor:d.fillcolor||"#FF0000",fillOpacity:d.fillopacity||.35,radius:d.radius||10,zIndex:100,id:d.hasOwnProperty("id")?d.id:""},d),d.hasOwnProperty("center")&&(f=q(d.center,!0),e.center=f),"function"===typeof f.lat&&(c=new google.maps.Circle(e),this._circles.push(c),c&&e.hasOwnProperty("event")&&e.event.hasOwnProperty("created")&&"function"===typeof e.event.created&&e.event.created.call(c,this),d.hasOwnProperty("event")&&
this.bindEvents(c,d.event))},markers:function(a,b,c){if(!b.hasOwnProperty("marker")||!Array.isArray(b.marker))return!1;var d={},e=0,f=0,d={},g=this._markers,h=this._labels,l=new google.maps.Geocoder,p=function(a,b){if(b===google.maps.GeocoderStatus.OK)g[f].setPosition(a[0].geometry.location);else throw"Geocoder Status: "+b;},e={maxZoom:null,gridSize:60};b.hasOwnProperty("markerCluster")&&"function"===typeof MarkerClusterer&&(e=k.extend({},e,b.markerCluster),this._clusters=new MarkerClusterer(a,[],
e),e.hasOwnProperty("event")&&this.bindEvents(this._clusters,e.event));if(!c||0===g.length){for(e=0;e<b.marker.length;e+=1)d=b.marker[e],d.hasOwnProperty("addr")&&(d.parseAddr=q(d.addr,!0),"string"===typeof d.parseAddr?this.markerGeocoder(a,d,b):this.markerDirect(a,d,b));c=w}if("modify"===c)for(e=0;e<b.marker.length;e+=1){if(b.marker[e].hasOwnProperty("id"))for(f=0;f<g.length;f+=1)if(b.marker[e].id===g[f].id&&b.marker[e].hasOwnProperty("addr"))d=q(b.marker[e].addr,!0),"string"===typeof d?l.geocode({address:d},
p):g[f].setPosition(d),b.marker[e].hasOwnProperty("text")&&(g[f].hasOwnProperty("infoWindow")?"function"===typeof g[f].infoWindow.setContent&&g[f].infoWindow.setContent(b.marker[e].text):(g[f].infoWindow=new google.maps.InfoWindow({content:b.marker[e].text}),this.bindEvents(g[f],b.marker[e].event))),b.marker[e].hasOwnProperty("icon")&&g[f].setIcon(b.marker[e].icon);else{if(b.marker[e].hasOwnProperty("forceInsert")&&!0===b.marker[e].forceInsert&&b.marker[e].hasOwnProperty("addr")){b.marker[e].parseAddr=
q(b.marker[e].addr,!0);"string"===typeof b.marker[e].parseAddr?this.markerGeocoder(a,b.marker[e],b):this.markerDirect(a,b.marker[e]);break}}else b.marker[e].hasOwnProperty("addr")&&(b.marker[e].parseAddr=q(b.marker[e].addr,!0),"string"===typeof b.marker[e].parseAddr?this.markerGeocoder(a,b.marker[e]):this.markerDirect(a,b.marker[e]));for(f=0;f<h.length;f+=1)b.marker[e].id===h[f].id&&(b.marker[e].hasOwnProperty("label")&&(h[f].text=b.marker[e].label),b.marker[e].hasOwnProperty("css")&&k(h[f].span).addClass(b.marker[e].css),
h[f].draw())}},markerIcon:function(a){var b=k.extend({},a.icon);if(a.hasOwnProperty("icon")){if("string"===typeof a.icon)return a.icon;a.icon.hasOwnProperty("url")&&(b.url=a.icon.url);a.icon.hasOwnProperty("size")&&Array.isArray(a.icon.size)&&2===a.icon.size.length&&(b.size=this.formatSize(a.icon));a.icon.hasOwnProperty("scaledSize")&&Array.isArray(a.icon.scaledSize)&&2===a.icon.scaledSize.length&&(b.scaledSize=this.formatSize(a.icon.scaledSize));a.icon.hasOwnProperty("anchor")&&Array.isArray(a.icon.anchor)&&
2===a.icon.anchor.length&&(b.anchor=this.formatPoint(a.icon.anchor))}return b},markerDirect:function(a,b){var c={},d={},e=b.hasOwnProperty("id")?b.id:"",c=b.hasOwnProperty("title")?b.title.toString().replace(/<([^>]+)>/g,""):!1,f=b.hasOwnProperty("text")?b.text.toString():!1,g=this.markerIcon(b),h={},l=k.extend({},{map:a,position:b.parseAddr,animation:null,id:e},b);c&&(l.title=c);f&&(h.content=f,b.hasOwnProperty("infoWindowOptions")&&(h=k.extend({},h,b.infoWindowOptions),h.hasOwnProperty("pixelOffset")&&
Array.isArray(h.pixelOffset)&&(h.pixelOffset=this.formatSize(h.pixelOffset))),l.text=f,l.infoWindow=new google.maps.InfoWindow(h));k.isEmptyObject(g)||(l.icon=g);b.hasOwnProperty("animation")&&"string"===typeof b.animation&&(l.animation=google.maps.Animation[b.animation.toUpperCase()]);c="function"===typeof MarkerWithLabel?new MarkerWithLabel(l):new google.maps.Marker(l);this._markers.push(c);c&&b.hasOwnProperty("event")&&b.event.hasOwnProperty("created")&&"function"===typeof b.event.created&&b.event.created.call(c,
this);c.hasOwnProperty("position")&&("function"===typeof c.getPosition&&this._bounds.extend(c.position),this.options.hasOwnProperty("markerFitBounds")&&!0===this.options.markerFitBounds&&this._markers.length===this.options.marker.length&&a.fitBounds(this._bounds));(!b.hasOwnProperty("cluster")||b.hasOwnProperty("cluster")&&!0===b.cluster)&&"function"===typeof this._clusters.addMarker&&this._clusters.addMarker(c);b.hasOwnProperty("newLabel")&&(d=new v({text:b.newLabel,map:a,css:b.hasOwnProperty("newLabelCSS")?
b.newLabelCSS.toString():"",id:e}),d.bindTo("position",c,"position"),d.bindTo("visible",c),this._labels.push(d));google.maps.event.addListener(c,"map_changed",function(){"function"===typeof d.setMap&&d.setMap(this.getMap())});this.bindEvents(c,b.event)},markerGeocoder:function(a,b,c){var d=this;(new google.maps.Geocoder).geocode({address:b.parseAddr},function(e,f){if(f===google.maps.GeocoderStatus.OVER_QUERY_LIMIT)u.setTimeout(function(){d.markerGeocoder(a,b)},d.interval);else if(f===google.maps.GeocoderStatus.OK){var g=
{},h={},l=b.hasOwnProperty("id")?b.id:"",g=b.hasOwnProperty("title")?b.title.toString().replace(/<([^>]+)>/g,""):!1,p=b.hasOwnProperty("text")?b.text.toString():!1,m={map:a,position:e[0].geometry.location,animation:null,visible:!0,id:l},q=d.markerIcon(b);g&&(m.title=g);p&&(m.text=p,m.infoWindow=new google.maps.InfoWindow({content:p}));k.isEmptyObject(q)||(m.icon=q);b.hasOwnProperty("animation")&&"string"===typeof b.animation&&(m.animation=google.maps.Animation[b.animation.toUpperCase()]);m=k.extend({},
m,b);g="function"===typeof MarkerWithLabel?new MarkerWithLabel(m):new google.maps.Marker(m);d._markers.push(g);g&&b.hasOwnProperty("event")&&b.event.hasOwnProperty("created")&&"function"===typeof b.event.created&&b.event.created.call(g,d);g.hasOwnProperty("position")&&("function"===typeof g.getPosition&&d._bounds.extend(g.position),d.options.hasOwnProperty("markerFitBounds")&&!0===d.options.markerFitBounds&&d._markers.length===c.marker.length&&a.fitBounds(d._bounds));(!b.hasOwnProperty("cluster")||
b.hasOwnProperty("cluster")&&!0===b.cluster)&&"function"===typeof d._clusters.addMarker&&d._clusters.addMarker(g);b.hasOwnProperty("newLabel")&&(h=new v({text:b.newLabel,map:d.map,css:b.hasOwnProperty("newLabelCSS")?b.newLabelCSS.toString():"",id:l}),h.bindTo("position",g,"position"),h.bindTo("text",g,"position"),h.bindTo("visible",g),d._labels.push(h));google.maps.event.addListener(g,"map_changed",function(){"function"===typeof h.setMap&&h.setMap(this.getMap())});d.bindEvents(g,b.event)}})},direction:function(a,
b){var c=0;if(b.hasOwnProperty("direction")&&Array.isArray(b.direction))for(c=0;c<b.direction.length;c+=1)"undefined"!==typeof b.direction[c]&&this.directionService(b.direction[c])},directionService:function(a){if(!a.hasOwnProperty("from")||!a.hasOwnProperty("to"))return!1;var b=this,c=new google.maps.DirectionsService,d=new google.maps.DirectionsRenderer,e={},f=[],g=[],h=new google.maps.InfoWindow,l=[],p={},m="",r="",n={travelMode:google.maps.DirectionsTravelMode.DRIVING,optimizeWaypoints:a.hasOwnProperty("optimize")?
a.optimize:!0};i=0;n.origin=q(a.from,!0);n.destination=q(a.to,!0);p=k.extend({},{infoWindow:h,map:b.map},a);a.hasOwnProperty("travel")&&google.maps.TravelMode[a.travel.toString().toUpperCase()]&&(n.travelMode=google.maps.TravelMode[a.travel.toString().toUpperCase()]);a.hasOwnProperty("panel")&&k(a.panel).length&&(p.panel=k(a.panel).get(0));if(a.hasOwnProperty("waypoint")&&Array.isArray(a.waypoint)){for(i=0;i<a.waypoint.length;i+=1)e={},"string"===typeof a.waypoint[i]||Array.isArray(a.waypoint[i])?
e={location:q(a.waypoint[i],!0),stopover:!0}:(a.waypoint[i].hasOwnProperty("location")&&(e.location=q(a.waypoint[i].location,!0)),e.stopover=a.waypoint[i].hasOwnProperty("stopover")?a.waypoint[i].stopover:!0),f.push(a.waypoint[i].text||a.waypoint[i].toString()),a.waypoint[i].hasOwnProperty("icon")&&g.push(a.waypoint[i].icon.toString()),l.push(e);n.waypoints=l}c.route(n,function(c,e){var l=[],k={},n=0;if(e===google.maps.DirectionsStatus.OK){l=c.routes[0].legs;try{for(a.hasOwnProperty("fromText")&&
(m=l[0].start_address=a.fromText),a.hasOwnProperty("toText")&&(1===l.length?l[0].end_address=a.toText:l[l.length-1].end_address=a.toText,r=a.toText),a.hasOwnProperty("icon")&&(p.suppressMarkers=!0,a.icon.hasOwnProperty("from")&&"string"===typeof a.icon.from&&b.directionServiceMarker(l[0].start_location,{icon:a.icon.from,text:m},h,a),a.icon.hasOwnProperty("to")&&"string"===typeof a.icon.to&&b.directionServiceMarker(l[l.length-1].end_location,{icon:a.icon.to,text:r},h,a)),n=0;n<l.length;n+=1)a.hasOwnProperty("icon")&&
(a.icon.hasOwnProperty("waypoint")&&"string"===typeof a.icon.waypoint?k.icon=a.icon.waypoint:"string"===typeof g[n-1]&&(k.icon=g[n-1]),k.text=f[n-1],b.directionServiceMarker(l[n].start_location,k,h,a))}catch(q){}b.bindEvents(d,a.event);d.setOptions(p);d.setDirections(c)}});b._directions.push(d)},directionServiceMarker:function(a,b,c,d){var e=this,f={},g=k.extend({},{position:a,map:e.map,id:d.hasOwnProperty("id")?d.id:""},b),h=new google.maps.Marker(g);g.hasOwnProperty("text")&&(f=function(){c.setPosition(a);
c.setContent(g.text);c.open(e.map,h)});e._directionsMarkers.push(h);e.bindEvents(h,f)},getDirectionsInfo:function(){var a=[],b=null,c=this._directions,d=0,e=0,f=0,g=0;if(c)for(f=0,d=c.length;f<d;f+=1)if(c[f].hasOwnProperty("directions")&&c[f].directions.hasOwnProperty("routes")&&"undefined"!==typeof c[f].directions.routes[0].legs)for(b=c[f].directions.routes[0].legs,a[f]=[],g=0,e=b.length;g<e;g+=1)a[f].push({from:b[g].start_address,to:b[g].end_address,distance:b[g].distance,duration:b[g].duration});
return a},streetView:function(a,b){var c=b.hasOwnProperty("streetViewObj")?b.streetViewObj:{},d={},d={};"function"===typeof a.getStreetView&&(c.hasOwnProperty("position")?(d=q(c.position,!0),c.position="object"===typeof d?a.getCenter():d):c.position=a.getCenter(),c.hasOwnProperty("pov")&&(c.pov=k.extend({},{heading:0,pitch:0,zoom:1},c.pov)),d=a.getStreetView(),d.setOptions(c),c.hasOwnProperty("event")&&this.bindEvents(d,c.event),c.hasOwnProperty("visible")&&d.setVisible(c.visible))},places:function(a,
b){var c=this,d={},d=b.hasOwnProperty("places")?b.places:{},e=k.extend({},{location:a.getCenter(),radius:100},d),f=0;e.location=q(e.location,!0);"undefined"!==typeof google.maps.places&&(d=new google.maps.places.PlacesService(a),d.nearbySearch(e,function(b,d){if(d===google.maps.places.PlacesServiceStatus.OK){c._places.push(b);if(e.hasOwnProperty("createMarker")&&!0===e.createMarker)for(f=0;f<b.length;f+=1)b[f].hasOwnProperty("geometry")&&c._markers.push(new google.maps.Marker({map:a,position:b[f].geometry.location}));
e.hasOwnProperty("callback")&&"function"===typeof e.callback&&e.callback.call(b)}}))},geoLocation:function(a,b){try{var c=this,d=navigator.geolocation,e={};d&&(b.hasOwnProperty("geolocation")&&(e=k.extend({},{maximumAge:6E5,timeout:3E3,enableHighAccuracy:!1},b.geolocation)),!0!==b.autoLocation&&"function"!==typeof b.autoLocation||d.getCurrentPosition(function(d){"undefined"!==typeof d&&"coords"in d&&"latitude"in d.coords&&"longitude"in d.coords&&(a.panTo(new google.maps.LatLng(d.coords.latitude,d.coords.longitude)),
"function"===typeof b.autoLocation&&b.autoLocation.call(c,d))},function(a){console.error(a)},e))}catch(f){}},panTo:function(a){var b=this.map,c={},d={};null!==b&&"undefined"!==typeof b&&(c=q(a,!0),"string"===typeof c?(d=new google.maps.Geocoder,d.geocode({address:c},function(a,c){c===google.maps.GeocoderStatus.OK&&"function"===typeof b.panTo&&Array.isArray(a)&&a.length?a[0].hasOwnProperty("geometry")&&b.panTo(a[0].geometry.location):console.error(c)})):"function"===typeof b.panTo&&b.panTo(c));return k(this.container)},
close:function(a,b){var c=this.get(a),d={},e={},f="",g=0;c.hasOwnProperty("map")&&delete c.map;Array.isArray(c)?e[a]=c:e=c;try{for(f in e)if(Array.isArray(e[f]))for(g=0;g<e[f].length;g+=1)d=e[f][g],d.hasOwnProperty("infoWindow")&&"function"===typeof d.infoWindow.close&&d.infoWindow.close();"function"===typeof b&&b.call(this)}catch(h){console.warn(h)}finally{return k(this.container)}},clear:function(a,b){var c=this._directionsMarkers,d=this._labels,e=this.get(a),f={},g={},h="",l=0;e.hasOwnProperty("map")&&
delete e.map;Array.isArray(e)?f[a]=e:f=e;try{for(h in f)if(key="_"+h.toString().toLowerCase()+"s",Array.isArray(f[h])){for(l=0;l<f[h].length;l+=1){g=f[h][l];"marker"===h&&"undefined"!==typeof d[l]&&d.hasOwnProperty("div")&&this._labels[l].div.remove();if("direction"===h){for(j=0;j<c.length;j+=1)"function"===typeof c[j].setMap&&this._directionsMarkers[j].setMap(null);this._directionsMarkers.filter(function(a){return w!==a})}"function"===typeof g.set&&g.set("visible",!1);"function"===typeof g.setMap&&
g.setMap(null);this[key][l]=w}this[key]=this[key].filter(function(a){return w!==a})}"function"===typeof b&&b.call(this)}catch(p){console.warn(p)}finally{return k(this.container)}},get:function(a,b){var c=[],d={},e={},f={},g="",h="",l=0;"undefined"===typeof a&&(a={marker:[],label:[],polygon:[],polyline:[],circle:[],direction:[],kml:[],cluster:[],bound:[]});try{if("string"===typeof a)if(~a.indexOf(","))for(c=a.replace(/\s/gi,"").split(","),l=0;l<c.length;l+=1)h=c[l].toString().toLowerCase(),"map"===
h?d[h]=this.map:(g="_"+h+"s",d[h]=this[g]);else"map"===a.toString().toLowerCase()?d=this.map:(g="_"+a.toString().toLowerCase()+"s",d=this[g]);else{for(f in a)if(Array.isArray(a[f])&&(g="_"+f.toString().toLowerCase()+"s",Array.isArray(this[g])))for(d[f]=[],l=0;l<this[g].length;l+=1)e=this[g][l],(0===a[f].length||-1!==a[f].indexOf(l)||e.hasOwnProperty("id")&&0<e.id.length&&~a[f].indexOf(e.id))&&d[f].push(e);d.map=this.map}"function"===typeof b&&b.call(this,d)}catch(k){console.warn(k)}finally{return d}},
modify:function(a){var b=[],c=[["kml","kml"],["marker","markers"],["direction","direction"],["polyline","drawPolyline"],["polygon","drawPolygon"],["circle","drawCircle"],["streetView","streetView"],["markerFitBounds","markerFitBounds"],["places","places"]],d=0,e=this.map;if("undefined"!==typeof a){for(d=0;d<c.length;d+=1)a.hasOwnProperty(c[d][0])&&b.push(c[d][1]);if(null!==e){if(b.length)for(d=0;d<b.length;d+=1)"function"===typeof this[b[d]]&&("streetView"===b[d]&&(a.streetViewObj=a.streetView,delete a.streetView),
this[b[d]](e,a,"modify"));else e.setOptions(a);a.hasOwnProperty("event")&&this.bindEvents(e,a.event);google.maps.event.trigger(e,"resize")}}return k(this.container)},destroy:function(){var a=k(this.container);a.length&&k.removeData(this.container,"tinyMap");return a.empty()},getKML:function(a){var b=k(this.container).data("tinyMap");a=k.extend({},{marker:!0,polyline:!0,direction:!0,download:!1},a);var c='<?xml version="1.0" encoding="UTF-8"?>;<kml xmlns="http://earth.google.com/kml/2.2">;<Document>;<name><![CDATA[]]\x3e</name>;<description><![CDATA[]]\x3e</description>;<Style id="style1">;<IconStyle>;<Icon>;<href>//maps.google.com/mapfiles/kml/paddle/grn-circle_maps.png</href>;</Icon>;</IconStyle>;</Style>;#PLACEMARKS#;</Document>;</kml>'.split(";"),
d="<Placemark> <name><![CDATA[]]\x3e</name> <Snippet></Snippet> <description><![CDATA[]]\x3e</description> <styleUrl>#style1</styleUrl> <ExtendedData> </ExtendedData> #DATA# </Placemark>".split(" "),e=[],f=[],f=[],g="",h="",l="",p="",p="",m=[],q=[],m={},n=0,r=e=-1,t=-1;if(b){if(!0===a.marker)for(e=b._markers,n=0;n<length;n+=1)p=e[n].position.lng()+","+e[n].position.lat(),g+=d.join("").replace(/#DATA#/gi,"<Point><coordinates>#LATLNG#,0.000000</coordinates></Point>".replace(/#LATLNG#/gi,p));if(!0===
a.polyline)for(f=b._polylines,n=0;n<f.length;n+=1){m=f[n].getPath().getArray();p="";for(e=0;e<m.length;e+=1)p+=m[e].lng()+","+m[e].lat()+",0.000000\n";h+=d.join("").replace(/#DATA#/gi,"<LineString><tessellate>1</tessellate><coordinates>#LATLNG#</coordinates></LineString>".replace(/#LATLNG#/gi,p))}if(!0===a.direction)for(f=b._directions,n=0;n<f.length;n+=1)if(f[n].hasOwnProperty("directions")&&f[n].directions.hasOwnProperty("routes")&&Array.isArray(f[n].directions.routes)&&0<f[n].directions.routes.length&&
f[n].directions.routes[0].hasOwnProperty("legs")&&Array.isArray(f[n].directions.routes[0].legs))for(m=f[n].directions.routes[0].legs,e=0;e<m.length;e+=1)if(Array.isArray(m[e].steps))for(r=0;e<m[e].steps.length;r+=1){p="";if(Array.isArray(m[e].steps[r].path))for(t=0;t<m[e].steps[r].path.length;t+=1)q=m[e].steps[r].path[t],"undefined"!==typeof q&&"function"===typeof q.lat&&(p+=q.lng()+","+q.lat()+",0.000000\n");l+=d.join("").replace(/#DATA#/gi,"<LineString><tessellate>1</tessellate><coordinates>#LATLNG#</coordinates></LineString>".replace(/#LATLNG#/gi,
p))}p=c.join("").replace(/#PLACEMARKS#/gi,g+h+l);if(!0===a.download)u.open("data:application/vnd.google-earth.kml+xml;charset=utf-8;base64,"+u.btoa(u.decodeURIComponent(u.encodeURIComponent(p))));else return p}},init:function(){var a=this,b={},b={},c=k.extend({},t),d=c.api.split("?")[0],e="",f={};try{delete c.api,delete c.clusterer,delete c.withLabel,c=k.param(c)}catch(g){}z||"undefined"!==typeof u.google||(b=r.createElement("script"),b.setAttribute("src",[d,c].join("?")),(r.getElementsByTagName("head")[0]||
r.documentElement).appendChild(b),z=!0,b=null);if("object"===typeof u.google){!A&&a.options.hasOwnProperty("markerCluster")&&!1!==a.options.markerCluster&&"undefined"===typeof MarkerClusterer&&(b=r.createElement("script"),b.setAttribute("src",t.clusterer),(r.getElementsByTagName("head")[0]||r.documentElement).appendChild(b),A=!0,b=null);!B&&a.options.hasOwnProperty("markerWithLabel")&&!0===a.options.markerWithLabel&&"undefined"===typeof MarkerWithLabel&&(b=r.createElement("script"),b.setAttribute("src",
t.withLabel),(r.getElementsByTagName("head")[0]||r.documentElement).appendChild(b),B=!0,b=null);a._bounds=new google.maps.LatLngBounds;v.prototype=new google.maps.OverlayView;v.prototype.onAdd=function(){this.div.appendTo(k(this.getPanes().overlayLayer));this.listeners=[google.maps.event.addListener(this,"visible_changed",this.onRemove)]};v.prototype.draw=function(){var a=this.getProjection(),b={};try{b=a.fromLatLngToDivPixel(this.get("position")),this.div.css({left:b.x+"px",top:b.y+"px",display:"block"}),
this.text&&this.span.html(this.text.toString())}catch(c){console.error(c)}};v.prototype.onRemove=function(){k(this.div).remove()};for(f in a.options)a.options.hasOwnProperty(f)&&(vo=a.options[f],/ControlOptions/g.test(f)&&vo.hasOwnProperty("position")&&"string"===typeof vo.position&&(a.options[f].position=google.maps.ControlPosition[vo.position.toUpperCase()]));a.googleMapOptions=a.options;a.options.hasOwnProperty("streetView")&&(a.googleMapOptions.streetViewObj=a.options.streetView,delete a.googleMapOptions.streetView);
a.googleMapOptions.center=q(a.options.center,!0);a.options.hasOwnProperty("styles")&&("string"===typeof a.options.styles&&y.hasOwnProperty(a.options.styles)?a.googleMapOptions.styles=y[a.options.styles]:Array.isArray(a.options.styles)&&(a.googleMapOptions.styles=a.options.styles));"string"===typeof a.options.center?(b=new google.maps.Geocoder,b.geocode({address:a.options.center},function(b,c){try{c===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?u.setTimeout(function(){a.init()},a.interval):c===google.maps.GeocoderStatus.OK&&
Array.isArray(b)?0<b.length&&b[0].hasOwnProperty("geometry")&&(a.googleMapOptions.center=b[0].geometry.location,a.map=new google.maps.Map(a.container,a.googleMapOptions),google.maps.event.addListenerOnce(a.map,"idle",function(){a.overlay();google.maps.event.trigger(a.map,"resize")}),a.bindEvents(a.map,a.options.event)):(e=(a.options.notFound||c).toString(),a.container.innerHTML(k("<div/>").text(e).html()),console.error("Geocoder Error Code: "+c))}catch(d){console.error(d)}})):(a.map=new google.maps.Map(a.container,
a.googleMapOptions),google.maps.event.addListenerOnce(a.map,"idle",function(){a.overlay();google.maps.event.trigger(a.map,"resize")}),a.bindEvents(a.map,a.options.event))}}};k.fn.tinyMapConfigure=function(a){t=k.extend(t,a)};k.fn.tinyMapDistance=function(a,b){var c={key:t.hasOwnProperty("key")?t.key:"",origins:[],destinations:[],language:"zh-TW"},c=k.extend({},c,a);Array.isArray(c.origins)&&(c.origins=c.origins.join("|"));Array.isArray(c.destinations)&&(c.destinations=c.destinations.join("|"));k.getJSON("//maps.googleapis.com/maps/api/distancematrix/json",
c,function(a){"OK"===a.status&&b.cal(this,a)})};k.fn.tinyMapQuery=function(a,b){var c={key:t.hasOwnProperty("key")?t.key:"",language:"zh-TW"},d=k.extend({},c,a),e=null;k.getJSON("//maps.googleapis.com/maps/api/geocode/json",d,function(a){"OK"===a.status&&a.results&&"undefined"!==typeof a.results[0]&&(d.hasOwnProperty("latlng")?e=a.results[0].formatted_address:d.hasOwnProperty("address")&&(e=[a.results[0].geometry.location.lat,a.results[0].geometry.location.lng].join()),b.call(this,e))})};k.fn.tinyMap=
function(a){var b={},c=[],d=arguments;return"string"===typeof a?(this.each(function(){b=k.data(this,"tinyMap");b instanceof x&&"function"===typeof b[a]&&(c=b[a].apply(b,Array.prototype.slice.call(d,1)))}),"undefined"!==typeof c?c:this):this.each(function(){k.data(this,"tinyMap")||k.data(this,"tinyMap",new x(this,a))})}})(window.jQuery||{},window,document);
